group 'jaxb.example'
version '1.0-SNAPSHOT'

apply plugin: 'java'

sourceCompatibility = 1.5

repositories {
    mavenCentral()
}

configurations {
    jaxb
}

dependencies {
    jaxb 'com.sun.xml.bind:jaxb-xjc:2.2.4-1'
}

task generateJaxbSources() {

    ext.schemaDir = "resource/"
    ext.generatedDir = file("resource/")

    inputs.dir schemaDir
    outputs.dir generatedDir

    doLast {

        ant.taskdef(name: 'xjc', classname: 'com.sun.tools.xjc.XJCTask', classpath: configurations.jaxb.asPath)
        ant.jaxbTargetDir = generatedDir

        ant.xjc(
                destdir: "${generatedDir}",
                package: "jaxb.kt",
                schema: "${schemaDir}/file.xsd",
                extension: 'true'
        )

    }
}

compileJava.dependsOn(":generateJaxbSources")
